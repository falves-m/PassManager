<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/main.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/main.py" />
              <option name="originalContent" value="import sys&#10;import json&#10;import password as ps&#10;import os&#10;from PySide6.QtGui import QGuiApplication&#10;&#10;from PySide6.QtWidgets import (&#10;    QApplication,&#10;    QLabel,&#10;    QMainWindow,&#10;    QPushButton,&#10;    QVBoxLayout,&#10;    QWidget, QListWidget, QLineEdit,&#10;)&#10;&#10;from password import hash_master_password&#10;&#10;&#10;def first_time():&#10;    if not os.path.exists(&quot;salt.bin&quot;):&#10;        with open(&quot;salt.bin&quot;, &quot;x&quot;) as salt_file:&#10;            ps.generate_salt()&#10;            return True&#10;    else:&#10;        return False&#10;&#10;def center_widget(widget):&#10;    screen = QGuiApplication.primaryScreen()&#10;    if screen is None:&#10;        return&#10;    screen_geo = screen.availableGeometry()&#10;    widget.adjustSize()&#10;    geom = widget.frameGeometry()&#10;    geom.moveCenter(screen_geo.center())&#10;    widget.move(geom.topLeft())&#10;&#10;class AddWindow(QWidget):&#10;    def __init__(self, list_widget: QListWidget):&#10;        super().__init__()&#10;&#10;        self.setWindowTitle(&quot;Add Site&quot;)&#10;&#10;        self.list_widget = list_widget&#10;&#10;        self.lineedit = QLineEdit()&#10;        self. lineedit.setPlaceholderText(&quot;Type your site&quot;)&#10;        self.lineedit.returnPressed.connect(self.return_pressed)&#10;&#10;        layout = QVBoxLayout()&#10;        layout.addWidget(self.lineedit)&#10;        self.setLayout(layout)&#10;&#10;        center_widget(self)&#10;&#10;    def return_pressed(self):&#10;        site = self.lineedit.text()&#10;        if site:&#10;            if ps.add_to_vault(site, ps.generate_password()):&#10;                self.list_widget.addItem(site)&#10;            self.close()&#10;&#10;class SetupWindow(QWidget):&#10;    def __init__(self, main_window: QMainWindow):&#10;        super().__init__()&#10;&#10;        layout = QVBoxLayout()&#10;        self.main = main_window&#10;        self.label = QLabel()&#10;        self.label.setText(&quot;Type your new mater password, you MUST remember it otherwise you will lose the data&quot;)&#10;        layout.addWidget(self.label)&#10;&#10;        self.setWindowTitle(&quot;Setup&quot;)&#10;&#10;        self.lineedit = QLineEdit()&#10;        self.lineedit.setPlaceholderText(&quot;Type your new master Password&quot;)&#10;        self.lineedit.setEchoMode(QLineEdit.EchoMode.Password)&#10;        layout.addWidget(self.lineedit)&#10;&#10;        self.lineeditconfirm = QLineEdit()&#10;        self.lineeditconfirm.setEchoMode(QLineEdit.EchoMode.NoEcho)&#10;        self.lineeditconfirm.setPlaceholderText(&quot;Confirm your new password&quot;)&#10;        self.lineeditconfirm.returnPressed.connect(self.return_pressed)&#10;        layout.addWidget(self.lineeditconfirm)&#10;&#10;        self.setLayout(layout)&#10;        center_widget(self)&#10;&#10;    def return_pressed(self):&#10;        if self.lineedit.text() == self.lineeditconfirm.text():&#10;            ps.add_to_vault(&quot;master&quot;, hash_master_password(self.lineedit.text()))&#10;            ps.master_password = self.lineedit.text()&#10;            self.main.show()&#10;            self.close()&#10;        else:&#10;            self.lineedit.setPlaceholderText(&quot;The two passwords are not the same&quot;)&#10;            self.lineeditconfirm.clear()&#10;            self.lineedit.clear()&#10;&#10;&#10;class MainWindow(QMainWindow):&#10;    def __init__(self, FT: bool):&#10;        super().__init__()&#10;        if FT:&#10;            self.set_password_window = SetupWindow(self)&#10;            self.set_password_window.show()&#10;        else:&#10;            self.login = LoginWindow(self)&#10;            self.login.show()&#10;            ps.init_vault()&#10;&#10;        self.setWindowTitle(&quot;PassManager&quot;)&#10;        central_widget = QWidget()&#10;        layout = QVBoxLayout()&#10;        central_widget.setLayout(layout)&#10;        self.setCentralWidget(central_widget)&#10;&#10;        self.list_widget = QListWidget()&#10;        self.list_widget.addItems(ps.sites)&#10;        self.list_widget.itemDoubleClicked.connect(self.on_item_clicked)&#10;        layout.addWidget(self.list_widget)&#10;&#10;        self.label = QLabel(&quot;Selected Passwords&quot;)&#10;        layout.addWidget(self.label)&#10;&#10;        self.add_button = QPushButton(&quot;Add&quot;)&#10;        self.add_button.clicked.connect(self.show_add_window)&#10;        layout.addWidget(self.add_button)&#10;&#10;        self.remove_button = QPushButton(&quot;Remove&quot;)&#10;        self.remove_button.clicked.connect(self.remove_button_clicked)&#10;        layout.addWidget(self.remove_button)&#10;&#10;        self.setLayout(layout)&#10;        center_widget(self)&#10;&#10;    def on_item_clicked(self, item):&#10;        self.label.setText(ps.get_password_from_vault(item.text()))&#10;        clipboard = QApplication.clipboard()&#10;        clipboard.setText(self.label.text())&#10;&#10;    def remove_button_clicked(self):&#10;        item = self.list_widget.currentItem()&#10;        if item is None:&#10;            return&#10;&#10;        with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;            vault_data = json.load(vault_file)&#10;&#10;        if item.text() in vault_data[&quot;vault&quot;]:&#10;            if item.text() == &quot;master&quot;:&#10;                return&#10;            vault_data[&quot;vault&quot;].pop(item.text())&#10;&#10;            with open(&quot;vault.json&quot;, &quot;w&quot;) as vault_file:&#10;                json.dump(vault_data, vault_file, indent=4)&#10;&#10;            row = self.list_widget.row(item)&#10;            self.list_widget.takeItem(row)&#10;&#10;    def show_add_window(self):&#10;        self.w = AddWindow(self.list_widget)&#10;        self.w.show()&#10;&#10;class LoginWindow(QListWidget):&#10;    def __init__(self, main_window: QMainWindow):&#10;        super().__init__()&#10;        self.main_window = main_window&#10;&#10;        self.lineedit = QLineEdit()&#10;        self.lineedit.setPlaceholderText(&quot;Type your master Password&quot;)&#10;        self.lineedit.returnPressed.connect(self.check_password)&#10;        self.setWindowTitle(&quot;Login&quot;)&#10;&#10;        layout = QVBoxLayout()&#10;        layout.addWidget(self.lineedit)&#10;        self.setLayout(layout)&#10;        center_widget(self)&#10;&#10;    def check_password(self):&#10;        password = self.lineedit.text()&#10;&#10;        if ps.check_master_password(self.lineedit.text(), ps.get_master_password()):&#10;            ps.master_password = password  # Set global variable&#10;            self.main_window.show()&#10;            self.close()&#10;        else:&#10;            self.lineedit.clear()&#10;            self.lineedit.setPlaceholderText(&quot;Wrong Password&quot;)&#10;&#10;&#10;&#10;lebool = first_time()&#10;app = QApplication(sys.argv)&#10;window = MainWindow(lebool)&#10;app.exec()&#10;" />
              <option name="updatedContent" value="import sys&#10;import json&#10;import password as ps&#10;import os&#10;from PySide6.QtGui import QGuiApplication&#10;&#10;from PySide6.QtWidgets import (&#10;    QApplication,&#10;    QLabel,&#10;    QMainWindow,&#10;    QPushButton,&#10;    QVBoxLayout,&#10;    QWidget, QListWidget, QLineEdit,&#10;)&#10;&#10;from password import hash_master_password&#10;&#10;&#10;def first_time():&#10;    if not os.path.exists(&quot;salt.bin&quot;):&#10;        with open(&quot;salt.bin&quot;, &quot;x&quot;) as salt_file:&#10;            ps.generate_salt()&#10;            return True&#10;    else:&#10;        return False&#10;&#10;def center_widget(widget):&#10;    screen = QGuiApplication.primaryScreen()&#10;    if screen is None:&#10;        return&#10;    screen_geo = screen.availableGeometry()&#10;    widget.adjustSize()&#10;    geom = widget.frameGeometry()&#10;    geom.moveCenter(screen_geo.center())&#10;    widget.move(geom.topLeft())&#10;&#10;class AddWindow(QWidget):&#10;    def __init__(self, list_widget: QListWidget):&#10;        super().__init__()&#10;&#10;        self.setWindowTitle(&quot;Add Site&quot;)&#10;&#10;        self.list_widget = list_widget&#10;&#10;        self.lineedit = QLineEdit()&#10;        self. lineedit.setPlaceholderText(&quot;Type your site&quot;)&#10;        self.lineedit.returnPressed.connect(self.return_pressed)&#10;&#10;        layout = QVBoxLayout()&#10;        layout.addWidget(self.lineedit)&#10;        self.setLayout(layout)&#10;&#10;        center_widget(self)&#10;&#10;    def return_pressed(self):&#10;        site = self.lineedit.text()&#10;        if site:&#10;            if ps.add_to_vault(site, ps.generate_password()):&#10;                self.list_widget.addItem(site)&#10;            self.close()&#10;&#10;class SetupWindow(QWidget):&#10;    def __init__(self, main_window: QMainWindow):&#10;        super().__init__()&#10;&#10;        layout = QVBoxLayout()&#10;        self.main = main_window&#10;        self.label = QLabel()&#10;        self.label.setText(&quot;Type your new mater password, you MUST remember it otherwise you will lose the data&quot;)&#10;        layout.addWidget(self.label)&#10;&#10;        self.setWindowTitle(&quot;Setup&quot;)&#10;&#10;        self.lineedit = QLineEdit()&#10;        self.lineedit.setPlaceholderText(&quot;Type your new master Password&quot;)&#10;        self.lineedit.setEchoMode(QLineEdit.EchoMode.Password)&#10;        layout.addWidget(self.lineedit)&#10;&#10;        self.lineeditconfirm = QLineEdit()&#10;        self.lineeditconfirm.setEchoMode(QLineEdit.EchoMode.NoEcho)&#10;        self.lineeditconfirm.setPlaceholderText(&quot;Confirm your new password&quot;)&#10;        self.lineeditconfirm.returnPressed.connect(self.return_pressed)&#10;        layout.addWidget(self.lineeditconfirm)&#10;&#10;        self.setLayout(layout)&#10;        center_widget(self)&#10;&#10;    def return_pressed(self):&#10;        if self.lineedit.text() == self.lineeditconfirm.text():&#10;            ps.add_to_vault(&quot;master&quot;, hash_master_password(self.lineedit.text()))&#10;            ps.master_password = self.lineedit.text()&#10;            self.main.show()&#10;            self.close()&#10;        else:&#10;            self.lineedit.setPlaceholderText(&quot;The two passwords are not the same&quot;)&#10;            self.lineeditconfirm.clear()&#10;            self.lineedit.clear()&#10;&#10;&#10;class MainWindow(QMainWindow):&#10;    def __init__(self, FT: bool):&#10;        super().__init__()&#10;        if FT:&#10;            self.set_password_window = SetupWindow(self)&#10;            self.set_password_window.show()&#10;        else:&#10;            self.login = LoginWindow(self)&#10;            self.login.show()&#10;            ps.init_vault()&#10;&#10;        self.setWindowTitle(&quot;PassManager&quot;)&#10;        central_widget = QWidget()&#10;        layout = QVBoxLayout()&#10;        central_widget.setLayout(layout)&#10;        self.setCentralWidget(central_widget)&#10;&#10;        self.list_widget = QListWidget()&#10;        self.list_widget.addItems(ps.sites)&#10;        self.list_widget.itemDoubleClicked.connect(self.on_item_clicked)&#10;        layout.addWidget(self.list_widget)&#10;&#10;        self.label = QLabel(&quot;Selected Passwords&quot;)&#10;        layout.addWidget(self.label)&#10;&#10;        self.add_button = QPushButton(&quot;Add&quot;)&#10;        self.add_button.clicked.connect(self.show_add_window)&#10;        layout.addWidget(self.add_button)&#10;&#10;        self.remove_button = QPushButton(&quot;Remove&quot;)&#10;        self.remove_button.clicked.connect(self.remove_button_clicked)&#10;        layout.addWidget(self.remove_button)&#10;&#10;        self.setLayout(layout)&#10;        center_widget(self)&#10;&#10;    def on_item_clicked(self, item):&#10;        self.label.setText(ps.get_password_from_vault(item.text()))&#10;        clipboard = QApplication.clipboard()&#10;        clipboard.setText(self.label.text())&#10;&#10;    def remove_button_clicked(self):&#10;        item = self.list_widget.currentItem()&#10;        if item is None:&#10;            return&#10;&#10;        with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;            vault_data = json.load(vault_file)&#10;&#10;        if item.text() in vault_data[&quot;vault&quot;]:&#10;            if item.text() == &quot;master&quot;:&#10;                return&#10;            vault_data[&quot;vault&quot;].pop(item.text())&#10;&#10;            with open(&quot;vault.json&quot;, &quot;w&quot;) as vault_file:&#10;                json.dump(vault_data, vault_file, indent=4)&#10;&#10;            row = self.list_widget.row(item)&#10;            self.list_widget.takeItem(row)&#10;&#10;    def show_add_window(self):&#10;        self.w = AddWindow(self.list_widget)&#10;        self.w.show()&#10;&#10;class LoginWindow(QListWidget):&#10;    def __init__(self, main_window: QMainWindow):&#10;        super().__init__()&#10;        self.main_window = main_window&#10;&#10;        self.lineedit = QLineEdit()&#10;        self.lineedit.setPlaceholderText(&quot;Type your master Password&quot;)&#10;        self.lineedit.returnPressed.connect(self.check_password)&#10;        self.setWindowTitle(&quot;Login&quot;)&#10;&#10;        layout = QVBoxLayout()&#10;        layout.addWidget(self.lineedit)&#10;        self.setLayout(layout)&#10;        center_widget(self)&#10;&#10;    def check_password(self):&#10;        password = self.lineedit.text()&#10;&#10;        if ps.check_master_password(self.lineedit.text(), ps.get_master_password()):&#10;            ps.master_password = password  # Set global variable&#10;            self.main_window.show()&#10;            self.close()&#10;        else:&#10;            self.lineedit.clear()&#10;            self.lineedit.setPlaceholderText(&quot;Wrong Password&quot;)&#10;&#10;&#10;&#10;lebool = first_time()&#10;app = QApplication(sys.argv)&#10;window = MainWindow(lebool)&#10;app.exec()&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/password.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/password.py" />
              <option name="originalContent" value="import json&#10;import os&#10;import secrets&#10;import base64&#10;from os import urandom&#10;from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC&#10;from cryptography.hazmat.primitives import hashes&#10;from cryptography.fernet import Fernet&#10;from argon2 import PasswordHasher&#10;from argon2.exceptions import VerifyMismatchError, VerificationError, InvalidHashError&#10;&#10;sites = []&#10;master_password = None  # Stores the verified master password (plain text)&#10;&#10;def init_vault():&#10;    if os.path.exists(&quot;vault.json&quot;):&#10;        with open(&quot;vault.json&quot;) as vault_file:&#10;            data = json.load(vault_file)&#10;&#10;        for site in data[&quot;vault&quot;]:&#10;            if site != &quot;master&quot;:&#10;                sites.append(site)&#10;&#10;def add_to_vault(site: str, password: str) -&gt; bool:&#10;    vault_data = {&quot;vault&quot;: {}}&#10;    &#10;    if os.path.exists(&quot;vault.json&quot;):&#10;        with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;            vault_data = json.load(vault_file)&#10;&#10;    if site in vault_data[&quot;vault&quot;]:&#10;        return False&#10;&#10;    vault_data[&quot;vault&quot;][site] = password&#10;&#10;    with open(&quot;vault.json&quot;, &quot;w&quot;) as vault_file:&#10;        json.dump(vault_data, vault_file, indent=4)&#10;        return True&#10;&#10;&#10;def generate_salt():&#10;    salt = urandom(16)&#10;    with open(&quot;salt.bin&quot;, &quot;wb&quot;) as salt_file:&#10;        salt_file.write(salt)&#10;    return salt&#10;&#10;def load_salt():&#10;    with open(&quot;salt.bin&quot;, &quot;rb&quot;) as f:&#10;        return f.read()&#10;&#10;def password_to_fernet_key(password: str, salt: bytes) -&gt; bytes:&#10;    kdf = PBKDF2HMAC(&#10;        algorithm=hashes.SHA256(),&#10;        length=32,&#10;        salt=salt,&#10;        iterations=390000,&#10;    )&#10;    key = base64.urlsafe_b64encode(kdf.derive(password.encode()))&#10;    return key&#10;&#10;def generate_password() -&gt; str:&#10;    salt = load_salt()&#10;    key = password_to_fernet_key(get_master_password(), salt)&#10;    cipher = Fernet(key)&#10;    random_bytes = secrets.token_bytes(16)&#10;    password = base64.urlsafe_b64encode(random_bytes).decode('utf-8')&#10;    token = cipher.encrypt(password.encode())&#10;    return token.decode()&#10;&#10;&#10;def get_master_password():&#10;    global master_password&#10;    if master_password is not None:&#10;        return master_password&#10;    with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;        vault_data = json.load(vault_file)&#10;        return vault_data[&quot;vault&quot;][&quot;master&quot;]&#10;&#10;def get_password_from_vault(site: str) -&gt; str:&#10;    with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;        vault_data = json.load(vault_file)&#10;        if site == &quot;master&quot;:&#10;            return vault_data[&quot;vault&quot;][&quot;master&quot;]&#10;        salt = load_salt()&#10;        key = password_to_fernet_key(get_master_password(), salt)&#10;        cipher = Fernet(key)&#10;        password = cipher.decrypt(vault_data[&quot;vault&quot;][site].encode())&#10;        return password.decode()&#10;&#10;def hash_master_password(password: str) -&gt; str:&#10;    ph = PasswordHasher()&#10;    hashed_password = ph.hash(password)&#10;    return hashed_password&#10;&#10;def check_master_password(password: str, hashed_password: str) -&gt; bool:&#10;    ph = PasswordHasher()&#10;    try:&#10;        ph.verify(hashed_password, password)&#10;        return True&#10;    except (VerifyMismatchError, VerificationError, InvalidHashError):&#10;        return False&#10;    except Exception as e:&#10;        print(f&quot;Error verifying password: {e}&quot;)&#10;        return False" />
              <option name="updatedContent" value="import json&#10;import os&#10;import secrets&#10;import base64&#10;from os import urandom&#10;from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC&#10;from cryptography.hazmat.primitives import hashes&#10;from cryptography.fernet import Fernet&#10;from argon2 import PasswordHasher&#10;from argon2.exceptions import VerifyMismatchError, VerificationError, InvalidHashError&#10;&#10;sites = []&#10;master_password = None  # Stores the verified master password (plain text)&#10;&#10;def init_vault():&#10;    if os.path.exists(&quot;vault.json&quot;):&#10;        with open(&quot;vault.json&quot;) as vault_file:&#10;            data = json.load(vault_file)&#10;&#10;        for site in data[&quot;vault&quot;]:&#10;            if site != &quot;master&quot;:&#10;                sites.append(site)&#10;&#10;def add_to_vault(site: str, password: str) -&gt; bool:&#10;    vault_data = {&quot;vault&quot;: {}}&#10;    &#10;    if os.path.exists(&quot;vault.json&quot;):&#10;        with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;            vault_data = json.load(vault_file)&#10;&#10;    if site in vault_data[&quot;vault&quot;]:&#10;        return False&#10;&#10;    vault_data[&quot;vault&quot;][site] = password&#10;&#10;    with open(&quot;vault.json&quot;, &quot;w&quot;) as vault_file:&#10;        json.dump(vault_data, vault_file, indent=4)&#10;        return True&#10;&#10;&#10;def generate_salt():&#10;    salt = urandom(16)&#10;    with open(&quot;salt.bin&quot;, &quot;wb&quot;) as salt_file:&#10;        salt_file.write(salt)&#10;    return salt&#10;&#10;def load_salt():&#10;    with open(&quot;salt.bin&quot;, &quot;rb&quot;) as f:&#10;        return f.read()&#10;&#10;def password_to_fernet_key(password: str, salt: bytes) -&gt; bytes:&#10;    kdf = PBKDF2HMAC(&#10;        algorithm=hashes.SHA256(),&#10;        length=32,&#10;        salt=salt,&#10;        iterations=390000,&#10;    )&#10;    key = base64.urlsafe_b64encode(kdf.derive(password.encode()))&#10;    return key&#10;&#10;def generate_password() -&gt; str:&#10;    salt = load_salt()&#10;    key = password_to_fernet_key(get_master_password(), salt)&#10;    cipher = Fernet(key)&#10;    random_bytes = secrets.token_bytes(16)&#10;    password = base64.urlsafe_b64encode(random_bytes).decode('utf-8')&#10;    token = cipher.encrypt(password.encode())&#10;    return token.decode()&#10;&#10;&#10;def get_master_password():&#10;    global master_password&#10;    if master_password is not None:&#10;        return master_password&#10;    with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;        vault_data = json.load(vault_file)&#10;        return vault_data[&quot;vault&quot;][&quot;master&quot;]&#10;&#10;def get_password_from_vault(site: str) -&gt; str:&#10;    with open(&quot;vault.json&quot;, &quot;r&quot;) as vault_file:&#10;        vault_data = json.load(vault_file)&#10;        if site == &quot;master&quot;:&#10;            return vault_data[&quot;vault&quot;][&quot;master&quot;]&#10;        salt = load_salt()&#10;        key = password_to_fernet_key(get_master_password(), salt)&#10;        cipher = Fernet(key)&#10;        password = cipher.decrypt(vault_data[&quot;vault&quot;][site].encode())&#10;        return password.decode()&#10;&#10;def hash_master_password(password: str) -&gt; str:&#10;    ph = PasswordHasher()&#10;    hashed_password = ph.hash(password)&#10;    return hashed_password&#10;&#10;def check_master_password(password: str, hashed_password: str) -&gt; bool:&#10;    ph = PasswordHasher()&#10;    try:&#10;        ph.verify(hashed_password, password)&#10;        return True&#10;    except (VerifyMismatchError, VerificationError, InvalidHashError):&#10;        return False&#10;    except Exception as e:&#10;        print(f&quot;Error verifying password: {e}&quot;)&#10;        return False" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>